/*
 !{id:msgpack.codec.js,ver:1.05,license:"MIT",author:"uupaa.js@gmail.com"} */
this.msgpack||function(d){function b(b){this._n=b}function a(b){l="string"===typeof b?j(b):b;c=-1;return i()}function e(a,h,f){var c,g,i;if(null==h)a.push(192);else if(!1===h)a.push(194);else if(!0===h)a.push(195);else switch(typeof h){case "number":h!==h?a.push(203,255,255,255,255,255,255,255,255):Infinity===h?a.push(203,127,240,0,0,0,0,0,0):Math.floor(h)===h?0>h?-32<=h?a.push(224+h+32):-128<h?a.push(208,h+256):-32768<h?(h+=65536,a.push(209,h>>8,h&255)):-2147483648<h?(h+=4294967296,a.push(210,h>>>
24,h>>16&255,h>>8&255,h&255)):(g=Math.floor(h/4294967296),h&=4294967295,a.push(211,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255)):128>h?a.push(h):256>h?a.push(204,h):65536>h?a.push(205,h>>8,h&255):4294967296>h?a.push(206,h>>>24,h>>16&255,h>>8&255,h&255):(g=Math.floor(h/4294967296),h&=4294967295,a.push(207,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255)):((g=0>h)&&(h*=-1),i=Math.log(h)/0.6931471805599453+1023|0,c=h*Math.pow(2,1075-i),h=c&4294967295,g&&
(i|=2048),g=c/4294967296&1048575|i<<20,a.push(203,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255));break;case "string":f=h.length;i=a.length;a.push(0);for(g=0;g<f;++g)c=h.charCodeAt(g),128>c?a.push(c&127):2048>c?a.push(c>>>6&31|192,c&63|128):65536>c&&a.push(c>>>12&15|224,c>>>6&63|128,c&63|128);c=a.length-i-1;32>c?a[i]=160+c:65536>c?a.splice(i,1,218,c>>8,c&255):4294967296>c&&a.splice(i,1,219,c>>>24,c>>16&255,c>>8&255,c&255);break;default:if(++f>=q)return o=1,[];if(r(h)){c=h.length;
16>c?a.push(144+c):65536>c?a.push(220,c>>8,c&255):4294967296>c&&a.push(221,c>>>24,c>>16&255,c>>8&255,c&255);for(g=0;g<c;++g)e(a,h[g],f)}else if(h instanceof b)c=h.valueOf(),(g=0>c)&&(c*=-1),i=Math.log(c)/0.6931471805599453+1023|0,c*=Math.pow(2,1075-i),h=c&4294967295,g&&(i|=2048),g=c/4294967296&1048575|i<<20,a.push(203,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255);else if(p(h)||h&&"[object Object]"!==Object.prototype.toString.call(h)&&"buffer"in h&&"[object ArrayBuffer]"===
Object.prototype.toString.call(h.buffer)){h=p(h)?new Uint8Array(h):new Uint8Array(h.buffer);c=h.byteLength;256>c?a.push(196,c&255):65536>c?a.push(196,c>>8,c&255):4294967296>c&&a.push(198,c>>>24,c>>16&255,c>>8&255,c&255);for(g=0;g<c;g++)a.push(h[g]);delete h}else{i=a.length;a.push(0);c=0;for(g in h)++c,e(a,g,f),e(a,h[g],f);16>c?a[i]=128+c:65536>c?a.splice(i,1,222,c>>8,c&255):4294967296>c&&a.splice(i,1,223,c>>>24,c>>16&255,c>>8&255,c&255)}}return a}function i(){var b,a,e;a=0;var d,g;g=l;e=g[++c];b=
g.length;if(224<=e)return e-256;if(192>e){if(128>e)return e;144>e?(a=e-128,e=128):160>e?(a=e-144,e=144):(a=e-160,e=160)}switch(e){case 192:return null;case 194:return!1;case 195:return!0;case 202:if(b<c+4+1)break;a=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];b=a>>23&255;d=a&8388607;return!a||2147483648===a?0:255===b?d?NaN:Infinity:(a&2147483648?-1:1)*(d|8388608)*Math.pow(2,b-127-23);case 203:if(b<c+8+1)break;a=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];e=a&2147483648;b=a>>20&2047;d=a&1048575;
if(!a||2147483648===a)return c+=4,0;if(2047===b)return c+=4,d?NaN:Infinity;a=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];return(e?-1:1)*((d|1048576)*Math.pow(2,b-1023-20)+a*Math.pow(2,b-1023-52));case 207:if(b<c+8+1)break;a=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];return 4294967296*a+16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];case 206:if(b<c+4+1)break;a+=16777216*g[++c]+(g[++c]<<16);case 205:if(b<c+2+1)break;a+=g[++c]<<8;case 204:if(b<c+1+1)break;return a+g[++c];case 211:if(b<c+8+
1)break;a=g[++c];return a&128?-1*(72057594037927936*(a^255)+281474976710656*(g[++c]^255)+1099511627776*(g[++c]^255)+4294967296*(g[++c]^255)+16777216*(g[++c]^255)+65536*(g[++c]^255)+256*(g[++c]^255)+(g[++c]^255)+1):72057594037927936*a+281474976710656*g[++c]+1099511627776*g[++c]+4294967296*g[++c]+16777216*g[++c]+65536*g[++c]+256*g[++c]+g[++c];case 210:if(b<c+4+1)break;a=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];return 2147483648>a?a:a-4294967296;case 209:if(b<c+2+1)break;a=(g[++c]<<8)+g[++c];
return 32768>a?a:a-65536;case 208:if(b<c+1+1)break;a=g[++c];return 128>a?a:a-256;case 219:if(b<c+4+1)break;a+=16777216*g[++c]+(g[++c]<<16);case 218:if(b<c+2+1)break;a+=g[++c]<<8;case 217:if(b<c+1)break;a+=g[++c];case 160:if(b<c+a+1)break;d=[];b=c;for(a=b+a;b<a;)e=g[++b],240<=e?(e=((e&3)<<18|(g[++b]&63)<<12|(g[++b]&63)<<6|g[++b]&63)-65536,d.push(55296+(e>>10)),d.push(56320+(e&1023))):d.push(128>e?e:224>e?(e&31)<<6|g[++b]&63:(e&15)<<12|(g[++b]&63)<<6|g[++b]&63);c=b;return 10240>d.length?n.apply(null,
d):f(d);case 198:if(b<c+4+1)break;a+=16777216*g[++c]+(g[++c]<<16);case 197:if(b<c+2+1)break;a+=g[++c]<<8;case 196:if(b<c+1)break;a+=g[++c];if(b<c+a+1)break;d=[];b=c;for(a=b+a;b<a;)e=g[++b],d.push(e);c=b;return 10240>d.length?n.apply(null,d):f(d);case 223:if(b<c+4+1)break;a+=16777216*g[++c]+(g[++c]<<16);case 222:if(b<c+2+1)break;a+=(g[++c]<<8)+g[++c];case 128:for(g={};a--;){if(b<c+1+1)return;e=i();if(void 0===e)return;d=e;e=i();if(void 0===e)return;g[d]=e}return g;case 221:if(b<c+4+1)break;a+=16777216*
g[++c]+(g[++c]<<16);case 220:if(b<c+2+1)break;a+=(g[++c]<<8)+g[++c];case 144:for(d=[];a--;){e=i();if(void 0===e)return;d.push(e)}return d}}function f(a){try{var b=n.apply(this,a);if(a.length!=b.length)throw"toString failed";return b}catch(c){}for(var b=[],e=0,g=a.length,f=m;e<g;++e)b[e]=f[a[e]];return b.join("")}function j(a){var b=[],c=k,e=a.split(""),f=-1,d;d=e.length;for(a=d%8;a--;)++f,b[f]=c[e[f]];for(a=d>>3;a--;)b.push(c[e[++f]],c[e[++f]],c[e[++f]],c[e[++f]],c[e[++f]],c[e[++f]],c[e[++f]],c[e[++f]]);
return b}d.msgpack={tofloat:b,unpacker:function(){var b={_chunk:[],_cidx:0,feed:function(a){a="string"===typeof a?j(a):a;b._chunk=b._chunk.concat(a)},unpack:function(){var e=a(b._chunk);if(void 0!==e)return b._cidx=c+1,b._chunk=b._chunk.slice(b._cidx),e},refresh:function(){b._chunk=[];b._cidx=0}};return b},pack:function(a,b){o=0;var c=e([],a,0);return o?!1:b?f(c):c},unpack:a};var k={},m={},l=[],c=0,o=0,r=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},p=function(a){return"[object ArrayBuffer]"===
Object.prototype.toString.call(a)},n=String.fromCharCode,q=512;b.prototype=new Number;b.prototype.valueOf=function(){return this._n};b.prototype.toString=function(){return this._n.toString()};(function(){for(var a=0,b;256>a;++a)b=n(a),k[b]=a,m[a]=b;for(a=128;256>a;++a)k[n(63232+a)]=a})()}(this);/*

 The MIT License (MIT)

 Copyright 2015 Sony Corporation

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
*/
this.linear||function(d){d.linear=function(){};d.linear.version="2.5.2";d.linear.sign="f59a3039d47e2a1001aa94402101cf8c833dd73b";d.linear.tofloat=function(b){return new msgpack.tofloat(b)};d.linear.tobinary=function(b){var a=Object.prototype.toString.call(b);if("[object String]"===a){for(var a=new Uint8Array(b.length),e=0;e<b.length;e++)a[e]=b.charCodeAt(e);return a.buffer}if("[object ArrayBuffer]"===a)return b;if(b&&"[object Object]"!==a&&"buffer"in b&&"[object ArrayBuffer]"===Object.prototype.toString.call(b.buffer))return b.buffer;
throw"can not convert into binary";};d.linear.base64=function(){var b=function(a){for(var b={},d=0,f=a.length;d<f;++d)b[a.charAt(d)]=d;return b}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");return{encode:function(a){var b=0;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";for(;a.length%3;)a+="\x00",b++;a=a.replace(/[\x00-\xFF]{3}/g,function(a){a=a.charCodeAt(0)<<16|a.charCodeAt(1)<<8|a.charCodeAt(2);return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>
18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)});if(!b)return a;for(a=a.substr(0,a.length-b);b--;)a+="=";return a},decode:function(a){var e=0;if("string"!==typeof a||a.length%4||null!==a.match(/[^A-Za-z0-9\+\/=]/)||-1!==a.indexOf("=")&&a.indexOf("=")<a.length-2)throw"INVALID_CHARACTER_ERR";for(a=
a.replace(/[^A-Za-z0-9\+\/]/g,"");a.length%4;)a+="A",e++;if(2<e)throw"INVALID_CHARACTER_ERR";a=a.replace(/[A-Za-z0-9\+\/]{4}/g,function(a){a=b[a.charAt(0)]<<18|b[a.charAt(1)]<<12|b[a.charAt(2)]<<6|b[a.charAt(3)];return String.fromCharCode(a>>16)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255)});1<=e&&(a=a.substring(0,a.length-[0,1,2][e]));return a}}}();d.linear.btoa=function(b){var a=d.btoa||d.linear.base64.encode;if("string"!==typeof b)throw"INVALID_CHARACTER_ERR";return a(b)};d.linear.atob=
function(b){var a=d.atob||d.linear.base64.decode;if("string"!==typeof b)throw"INVALID_CHARACTER_ERR";return a(b)};d.linear.extend=function(b,a){var e=new b;if(!a)return e;for(var d in a)e[d]!==a[d]&&(e[d]=a[d]);return e};d.linear.codec=function(){this.type=void 0};d.linear.codec.prototype.encode=function(b){return b};d.linear.codec.prototype.decode=function(b){return b};d.linear.codec.prototype.refresh=function(){};d.linear.codec.plain=function(){this.type="plain";return d.linear.extend(d.linear.codec,
this)};d.linear.codec.msgpack=function(){this.type="msgpack";this.unpacker=new msgpack.unpacker;return d.linear.extend(d.linear.codec,this)};d.linear.codec.msgpack.prototype.encode=function(b){return msgpack.pack(b)};d.linear.codec.msgpack.prototype.decode=function(b){var a=[];for(this.unpacker.feed(b);void 0!==(b=this.unpacker.unpack());)a.push(b);return a};d.linear.codec.msgpack.prototype.refresh=function(){this.unpacker.refresh()};d.linear.protocol=function(){this.codec=this.type=void 0};d.linear.protocol.prototype.request=
function(){throw Error("method is not allowed");};d.linear.protocol.prototype.response=function(){throw Error("method is not allowed");};d.linear.protocol.prototype.notify=function(){throw Error("method is not allowed");};d.linear.protocol.prototype.onmessage=function(b){return b};d.linear.protocol.prototype.reset=function(){};d.linear.protocol.plain=function(){this.type="plain";this.codec=new linear.codec.plain;return d.linear.extend(d.linear.protocol,this)};d.linear.protocol.plain.prototype.onmessage=
function(b){var a=[];b&&a.push({type:"notify",data:{name:void 0,data:b}});return a};d.linear.protocol.linear=function(){this.type="linear";this.msgid=0;this.codec=new d.linear.codec.msgpack;this.requests={};return d.linear.extend(d.linear.protocol,this)};d.linear.protocol.linear.prototype.request=function(b){var a=this,e={},d;if(b&&!("[object Object]"!==Object.prototype.toString.call(b)||!("method"in b)||!("params"in b))){do a.msgid=4294967295<=a.msgid?0:a.msgid+1;while(a.requests[a.msgid]);d=a.codec.encode([0,
a.msgid,b.method,b.params]);e.id=a.msgid;e.onresponse=b.onresponse;e.timeout=setTimeout(function(){a.ontimeout(e.id)},0<b.timeout?b.timeout:3E4);a.requests[e.id]=e;return{id:e.id,data:d,timeout:0<b.timeout?b.timeout:3E4}}};d.linear.protocol.linear.prototype.response=function(b){return!b||"[object Object]"!==Object.prototype.toString.call(b)||!("id"in b)?void 0:this.codec.encode([1,b.id,b.error,b.result])};d.linear.protocol.linear.prototype.notify=function(b){return!b||"[object Object]"!==Object.prototype.toString.call(b)||
!("name"in b)||!("data"in b)?void 0:this.codec.encode([2,b.name,b.data])};d.linear.protocol.linear.prototype.ontimeout=function(b){this.requests[b]&&("function"===typeof this.requests[b].onresponse&&this.requests[b].onresponse.call(this,{id:b,error:"timeout",result:null}),delete this.requests[b])};d.linear.protocol.linear.prototype.onmessage=function(b){var a=Object.prototype.toString.call(b),e,i=[],f,j;if("[object String]"===a)try{e=d.linear.atob(b)}catch(k){return console&&console.log("invalid data"),
i}else if("[object ArrayBuffer]"===a)e=Array.prototype.slice.call(new Uint8Array(b));else if("[object Array]"===a||"[object Number]"===a)e=b;else return console&&console.log("invalid data"),i;b=this.codec.decode(e);a=0;for(e=b.length;a<e;++a)switch(b[a][0]){case 0:i.push({type:"request",data:{id:b[a][1],method:b[a][2],params:b[a][3]}});break;case 1:f=b[a][1];this.requests[f]&&(clearTimeout(this.requests.timer),"function"===typeof this.requests[f].onresponse?this.requests[f].onresponse.call(this,{id:f,
error:b[a][2],result:b[a][3]}):i.push({type:"response",data:{id:f,error:b[a][2],result:b[a][3]}}),delete this.requests[f]);break;case 2:f=b[a][1];j=b[a][2];i.push({type:"notify",data:{name:f,data:j}});break;default:console&&console.log("invalid data")}return i};d.linear.protocol.linear.prototype.reset=function(){this.codec.refresh()};d.linear.transport=function(){this.state="disconnected";this.sendbuffer=[];this.num2bin=[];for(var b=0;256>b;++b)this.num2bin[b]=String.fromCharCode(b)};d.linear.transport.create=
function(b){var a,e,d,f,j,k,m,l={},c;for(c in b)"type"===c.toLowerCase()&&(a=b[c]),"channel"===c.toLowerCase()&&(f=b[c]),"host"===c.toLowerCase()&&(e=b[c]),"port"===c.toLowerCase()&&(d=b[c]),"path"===c.toLowerCase()&&(j=b[c]),"usessl"===c.toLowerCase()&&(m=!!b[c]),"options"===c.toLowerCase()&&(k=b[c]);"undefined"===typeof m&&(m=!!location.protocol.match(/https/));a=a||"websocket";e=e||location.hostname;d=parseInt(d||location.port,10)||(m?443:80);f=f||"linear";f=f.match(/^\//)?f:"/"+f;if("websocket"===
a)b=m?"wss://"+e+(443===d?"":":"+d)+f:"ws://"+e+(80===d?"":":"+d)+f;else if("polling"===a)j=j||"cgi/linear.fcgi",j=j.match(/^\//)?j:"/"+j,b=m?"https://"+e+(443===d?"":":"+d)+j:"http://"+e+(80===d?"":":"+d)+j;else{console&&console.log("transport: "+l.type+" is not implemented.");return}l.type=a;l.entry={};l.entry.url=b;l.entry.channel=f;l.entry.options=k;return l};d.linear.transport.prototype.connect=function(b){function a(){f.type="websocket";f.raw=new d.linear.transport.websocket(i);f.raw.onopen=
function(a){f._onopen(a)};f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)};f.raw.onmessage=function(a){f._onmessage(a)};f._onopen()}function e(){i=void 0;f.entry.polling?(f.type="polling",f.raw=new d.linear.transport.polling(f.entry.polling.url,f.entry.polling.channel,f.entry.polling.options,function(){f._onopen()},function(){f._onclose()}),f.raw.onopen=function(a){f._onopen(a)},f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)},f.raw.onmessage=function(a){f._onmessage(a)}):f._onclose()}
var i,f=this;if(!("connecting"===f.state||"connected"===f.state))if(f.state="connecting",b=b&&b.timeout?b.timeout:3E4,f.entry.websocket){try{i=new WebSocket(f.entry.websocket.url)}catch(j){if(!f.entry.polling){f._onclose();return}f.type="polling";f.raw=new d.linear.transport.polling(f.entry.polling.url,f.entry.polling.channel,f.entry.polling.options,function(){f._onopen()},function(){f._onclose()});f.raw.onopen=function(a){f._onopen(a)};f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)};f.raw.onmessage=
function(a){f._onmessage(a)};return}i.onopen=a;i.onclose=e;setTimeout(function(){"connecting"===f.state&&e()},b)}else f.entry.polling?(f.type="polling",f.raw=new d.linear.transport.polling(f.entry.polling.url,f.entry.polling.channel,f.entry.polling.options,function(){f._onopen()},function(){f._onclose()}),f.raw.onopen=function(a){f._onopen(a)},f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)},f.raw.onmessage=function(a){f._onmessage(a)},setTimeout(function(){"connecting"===f.state&&f._onclose()},
b)):f._onclose()};d.linear.transport.prototype._onopen=function(b){if("connecting"===this.state){this.state="connected";for(var a=0,e=this.sendbuffer.length;a<e;++a)this.send(this.sendbuffer[a]);this.sendbuffer=[];if("function"===typeof this.onopen)this.onopen(b)}};d.linear.transport.prototype._onclose=function(b){if("disconnected"!==this.state&&(this.state="disconnected","function"===typeof this.onclose))this.onclose(b)};d.linear.transport.prototype._onmessage=function(b){if("connected"===this.state&&
"function"===typeof this.onmessage)this.onmessage(b)};d.linear.transport.prototype.disconnect=function(){"disconnected"!==this.state&&(this.state="disconnecting",this.sendbuffer=[],"function"===typeof this.raw.disconnect&&this.raw.disconnect())};d.linear.transport.prototype.send=function(b){var a,e=Object.prototype.toString.call(b);if(!("disconnecting"===this.state||"disconnected"===this.state))if("connecting"===this.state)this.sendbuffer[this.sendbuffer.length]=b;else{if("[object String]"===e)a=
b;else if("[object Array]"===e||"[object ArrayBuffer]"===e||"[object Uint8Array]"===e)if("text"===this.raw.type){a=[];for(var e=0,i=b.length;e<i;++e)a[e]=this.num2bin[b[e]];a=d.linear.btoa(a.join(""))}else"binary"===this.raw.type&&(a=(new Uint8Array(b)).buffer);else return;this.raw.send(a)}};d.linear.transport.websocket=function(b){var a=this;a.socket=b;"binaryType"in a.socket?(a.socket.binaryType="arraybuffer",a.type="binary"):a.type="text";a.socket.onopen=function(b){if(typeof a.onopen==="function")a.onopen(b)};
a.socket.onclose=a.socket.onerror=function(b){if(typeof a.onclose==="function")a.onclose(b);a.socket=void 0};a.socket.onmessage=function(b){if(typeof a.onmessage==="function")a.onmessage(b.data)}};d.linear.transport.websocket.prototype.disconnect=function(){this.socket.close()};d.linear.transport.websocket.prototype.send=function(b){this.socket.send(b)};d.linear.jsonp={load:function(b,a,e){var d=document.createElement("iframe");d.style.display="none";document.body.appendChild(d);var f=d.contentWindow.document,
j=!1;d[d.readyState?"onreadystatechange":"onload"]=function(){this.readyState&&"complete"!=this.readyState||j||(j=!0,f.x?"function"===typeof a&&a.apply(this,f.x):"function"===typeof e&&e(),setTimeout(function(){try{d.parentNode.removeChild(d)}catch(a){}},0))};b=b+(0>b.indexOf("?")?"?":"&")+"f=cb&"+(new Date).getTime();f.write('<script>function cb(){document.x=arguments}<\/script><script src="'+b+'"><\/script>');f.close();return d},abort:function(b){b&&b.parentNode&&b.parentNode.removeChild(b)}};d.linear.transport.polling=
function(b,a,e,i,f){this.type="text";this.url=b;this.channel=a;this.options=e||{};this.seq=0;this.sid=void 0;var j=this,k="?c=connect&ch="+this.channel;j.state="connecting";d.linear.jsonp.load(this.url+k,function(a){j.sid=a.sid;"connecting"!==j.state?(k="?c=disconnect&sid="+j.sid,d.linear.jsonp.load(j.url+k)):(j.dopoll(),"function"===typeof i&&i())},f)};d.linear.transport.polling.prototype.disconnect=function(){var b="?c=disconnect&sid="+this.sid;if("disconnecting"!==this.state&&(this.state="disconnecting",
this.intervaltimer&&clearTimeout(this.intervaltimer),this.seq=this.intervaltimer=0,void 0!==this.sid&&d.linear.jsonp.load(this.url+b),this.sid=void 0,"function"===typeof this.onclose))this.onclose()};d.linear.transport.polling.prototype.send=function(b){function a(b,d){if(d.confirmed)try{b.parentNode.removeChild(b),d.parentNode.removeChild(d)}catch(e){}else d.confirmed=!0,b.submit(),setTimeout(function(){a(b,d)},j)}var d,i,f,j=this.options.gc||3E3;void 0===this.sid||"disconnecting"===this.state||
(d=document.createElement("form"),d.style.display="none",d.action=this.url,d.method="POST",d.target="ifr"+this.seq,document.body.appendChild(d),i=document.createElement("input"),i.type="text",i.name="sid",i.value=this.sid,d.appendChild(i),i=document.createElement("input"),i.type="text",i.name="data",i.value=b,d.appendChild(i),f=document.createElement("iframe"),f.style.display="none",f.name="ifr"+this.seq++,f.src="about:blank",f.onload=function(){a(d,f)},document.all&&(f.onreadystatechange=function(){"complete"===
this.readyState&&(f.contentWindow.name=f.name,a(d,f))}),document.body.appendChild(f))};d.linear.transport.polling.prototype.dopoll=function(){function b(a){if(a&&"function"===typeof e.onmessage)e.onmessage(a);e.intervaltimer=setTimeout(function(){e.dopoll()},i)}function a(){e.disconnect()}var e=this,i,f="?c=poll&sid="+this.sid;void 0===this.sid||"disconnecting"===this.state||(i=e.options?e.options.interval||250:250,d.linear.jsonp.load(this.url+f,b,a))};d.linear.client=function(b){var a=this,e,i;if("function"!==
typeof a){for(var f in b)"protocol"===f.toLowerCase()&&(e=b[f]),"transports"===f.toLowerCase()&&(i=b[f]);e=e?e:"linear";try{a.protocol=new d.linear.protocol[e]}catch(j){console&&console.log("protocol: "+e+" is not implemented."),a.protocol=new d.linear.protocol.linear}a.transport=new d.linear.transport;a.transport.onopen=function(b){a._onopen(b)};a.transport.onclose=function(b){a._onclose(b)};a.transport.onmessage=function(b){a._onmessage(b)};a.transport.entry={};b=Object.prototype.toString.call(i);
if("[object String]"===b){if(b=d.linear.transport.create({type:i}))a.transport.entry[b.type]=b.entry}else if("[object Array]"===b){e=0;for(f=i.length;e<f;e++)if(b="string"===typeof i[e]?d.linear.transport.create({type:i[e]}):d.linear.transport.create(i[e]))a.transport.entry[b.type]=b.entry,b=void 0}else if(void 0!==i&&"[object Object]"===b){if(b=d.linear.transport.create(i))a.transport.entry[b.type]=b.entry}else b=d.linear.transport.create({type:"websocket"}),a.transport.entry[b.type]=b.entry,b=d.linear.transport.create({type:"polling"}),
a.transport.entry[b.type]=b.entry;return a}};d.linear.client.prototype.state=function(){return this.transport.state};d.linear.client.prototype.connect=function(b){"function"===typeof this.transport.connect&&this.transport.connect(b)};d.linear.client.prototype.onconnect=function(b){"function"===typeof b&&(this.onconnect=b)};d.linear.client.prototype.disconnect=function(){"function"===typeof this.transport.disconnect&&this.transport.disconnect()};d.linear.client.prototype.ondisconnect=function(b){"function"===
typeof b&&(this.ondisconnect=b)};d.linear.client.prototype.request=function(b){var a;if("function"===typeof this.protocol.request){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return-1;try{a=this.protocol.request(b)}catch(d){return-1}if(!a)return-1;this.transport.send(a.data)}else return-1;return a.id};d.linear.client.prototype.onresponse=function(b){"function"===typeof b&&(this.onresponse=b)};d.linear.client.prototype.response=function(b){var a;if("function"===
typeof this.protocol.response){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return!1;try{a=this.protocol.response(b)}catch(d){return!1}if(!a)return!1;this.transport.send(a)}else return!1;return!0};d.linear.client.prototype.notify=function(b){var a;if("function"===typeof this.protocol.notify){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return!1;try{a=this.protocol.notify(b)}catch(d){return!1}if(!a)return!1;this.transport.send(a)}else return!1;
return!0};d.linear.client.prototype.onnotify=function(b){"function"===typeof b&&(this.onnotify=b)};d.linear.client.prototype._onopen=function(){var b;this.hasOwnProperty("onconnect")&&"function"===typeof this.onconnect&&(document?"createEvent"in document?(b=document.createEvent("Event"),b.initEvent("connected",!0,!0)):"createEventObject"in document?(b=document.createEventObject(),b.type="connected"):b={type:"connected"}:b={type:"connected"},this.onconnect(b))};d.linear.client.prototype._onclose=function(){var b;
this.protocol.reset();this.hasOwnProperty("ondisconnect")&&"function"===typeof this.ondisconnect&&(document?"createEvent"in document?(b=document.createEvent("Event"),b.initEvent("disconnected",!0,!0)):"createEventObject"in document?(b=document.createEventObject(),b.type="disconnected"):b={type:"disconnected"}:b={type:"disconnected"},this.ondisconnect(b))};d.linear.client.prototype._onmessage=function(b){for(var b=this.protocol.onmessage(b),a=0,d=b.length;a<d;a++)"request"===b[a].type?this.hasOwnProperty("onrequest")&&
"function"===typeof this.onrequest&&this.onrequest.call(this,b[a].data):"response"===b[a].type?this.hasOwnProperty("onresponse")&&"function"===typeof this.onresponse&&this.onresponse.call(this,b[a].data):"notify"===b[a].type&&this.hasOwnProperty("onnotify")&&"function"===typeof this.onnotify&&this.onnotify.call(this,b[a].data)}}(this);
