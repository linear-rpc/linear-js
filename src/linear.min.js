/*
 !{id:msgpack.codec.js,ver:1.05,license:"MIT",author:"uupaa.js@gmail.com"} */
this.msgpack||function(g){function a(a){this._n=a}function c(a){m="string"===typeof a?j(a):a;f=-1;return b()}function e(b,d,c){var i,h,f;if(null==d)b.push(192);else if(!1===d)b.push(194);else if(!0===d)b.push(195);else switch(typeof d){case "number":d!==d?b.push(203,255,255,255,255,255,255,255,255):Infinity===d?b.push(203,127,240,0,0,0,0,0,0):Math.floor(d)===d?0>d?-32<=d?b.push(224+d+32):-128<d?b.push(208,d+256):-32768<d?(d+=65536,b.push(209,d>>8,d&255)):-2147483648<d?(d+=4294967296,b.push(210,d>>>
24,d>>16&255,d>>8&255,d&255)):(h=Math.floor(d/4294967296),d&=4294967295,b.push(211,h>>24&255,h>>16&255,h>>8&255,h&255,d>>24&255,d>>16&255,d>>8&255,d&255)):128>d?b.push(d):256>d?b.push(204,d):65536>d?b.push(205,d>>8,d&255):4294967296>d?b.push(206,d>>>24,d>>16&255,d>>8&255,d&255):(h=Math.floor(d/4294967296),d&=4294967295,b.push(207,h>>24&255,h>>16&255,h>>8&255,h&255,d>>24&255,d>>16&255,d>>8&255,d&255)):((h=0>d)&&(d*=-1),f=Math.log(d)/0.6931471805599453+1023|0,i=d*Math.pow(2,1075-f),d=i&4294967295,h&&
(f|=2048),h=i/4294967296&1048575|f<<20,b.push(203,h>>24&255,h>>16&255,h>>8&255,h&255,d>>24&255,d>>16&255,d>>8&255,d&255));break;case "string":c=d.length;f=b.length;b.push(0);for(h=0;h<c;++h)i=d.charCodeAt(h),128>i?b.push(i&127):2048>i?b.push(i>>>6&31|192,i&63|128):55296>i||57343<i?b.push(i>>>12&15|224,i>>>6&63|128,i&63|128):(i=(i-55296<<10|d.charCodeAt(++h)-56320)+65536,b.push(i>>>18|240,i>>>12&63|128,i>>>6&63|128,i&63|128));i=b.length-f-1;32>i?b[f]=160+i:65536>i?b.splice(f,1,218,i>>8,i&255):4294967296>
i&&b.splice(f,1,219,i>>>24,i>>16&255,i>>8&255,i&255);break;default:if(++c>=r)return p=1,[];if(s(d)){i=d.length;16>i?b.push(144+i):65536>i?b.push(220,i>>8,i&255):4294967296>i&&b.push(221,i>>>24,i>>16&255,i>>8&255,i&255);for(h=0;h<i;++h)e(b,d[h],c)}else if(d instanceof a)i=d.valueOf(),(h=0>i)&&(i*=-1),f=Math.log(i)/0.6931471805599453+1023|0,i*=Math.pow(2,1075-f),d=i&4294967295,h&&(f|=2048),h=i/4294967296&1048575|f<<20,b.push(203,h>>24&255,h>>16&255,h>>8&255,h&255,d>>24&255,d>>16&255,d>>8&255,d&255);
else if(q(d)||d&&"[object Object]"!==Object.prototype.toString.call(d)&&"buffer"in d&&"[object ArrayBuffer]"===Object.prototype.toString.call(d.buffer)){d=q(d)?new Uint8Array(d):new Uint8Array(d.buffer);i=d.byteLength;256>i?b.push(196,i&255):65536>i?b.push(196,i>>8,i&255):4294967296>i&&b.push(198,i>>>24,i>>16&255,i>>8&255,i&255);for(h=0;h<i;h++)b.push(d[h]);delete d}else{f=b.length;b.push(0);i=0;for(h in d)++i,e(b,h,c),e(b,d[h],c);16>i?b[f]=128+i:65536>i?b.splice(f,1,222,i>>8,i&255):4294967296>i&&
b.splice(f,1,223,i>>>24,i>>16&255,i>>8&255,i&255)}}return b}function b(){var a,d,c;d=0;var e,h;h=m;c=h[++f];a=h.length;if(224<=c)return c-256;if(192>c){if(128>c)return c;144>c?(d=c-128,c=128):160>c?(d=c-144,c=144):(d=c-160,c=160)}switch(c){case 192:return null;case 194:return!1;case 195:return!0;case 202:if(a<f+4+1)break;d=16777216*h[++f]+(h[++f]<<16)+(h[++f]<<8)+h[++f];a=d>>23&255;e=d&8388607;return!d||2147483648===d?0:255===a?e?NaN:Infinity:(d&2147483648?-1:1)*(e|8388608)*Math.pow(2,a-127-23);case 203:if(a<
f+8+1)break;d=16777216*h[++f]+(h[++f]<<16)+(h[++f]<<8)+h[++f];c=d&2147483648;a=d>>20&2047;e=d&1048575;if(!d||2147483648===d)return f+=4,0;if(2047===a)return f+=4,e?NaN:Infinity;d=16777216*h[++f]+(h[++f]<<16)+(h[++f]<<8)+h[++f];return(c?-1:1)*((e|1048576)*Math.pow(2,a-1023-20)+d*Math.pow(2,a-1023-52));case 207:if(a<f+8+1)break;d=16777216*h[++f]+(h[++f]<<16)+(h[++f]<<8)+h[++f];return 4294967296*d+16777216*h[++f]+(h[++f]<<16)+(h[++f]<<8)+h[++f];case 206:if(a<f+4+1)break;d+=16777216*h[++f]+(h[++f]<<16);
case 205:if(a<f+2+1)break;d+=h[++f]<<8;case 204:if(a<f+1+1)break;return d+h[++f];case 211:if(a<f+8+1)break;d=h[++f];return d&128?-1*(72057594037927936*(d^255)+281474976710656*(h[++f]^255)+1099511627776*(h[++f]^255)+4294967296*(h[++f]^255)+16777216*(h[++f]^255)+65536*(h[++f]^255)+256*(h[++f]^255)+(h[++f]^255)+1):72057594037927936*d+281474976710656*h[++f]+1099511627776*h[++f]+4294967296*h[++f]+16777216*h[++f]+65536*h[++f]+256*h[++f]+h[++f];case 210:if(a<f+4+1)break;d=16777216*h[++f]+(h[++f]<<16)+(h[++f]<<
8)+h[++f];return 2147483648>d?d:d-4294967296;case 209:if(a<f+2+1)break;d=(h[++f]<<8)+h[++f];return 32768>d?d:d-65536;case 208:if(a<f+1+1)break;d=h[++f];return 128>d?d:d-256;case 219:if(a<f+4+1)break;d+=16777216*h[++f]+(h[++f]<<16);case 218:if(a<f+2+1)break;d+=h[++f]<<8;case 217:if(a<f+1)break;d+=h[++f];case 160:if(a<f+d+1)break;e=[];a=f;for(d=a+d;a<d;)c=h[++a],240<=c?(c=((c&3)<<18|(h[++a]&63)<<12|(h[++a]&63)<<6|h[++a]&63)-65536,e.push(55296+(c>>10)),e.push(56320+(c&1023))):e.push(128>c?c:224>c?(c&
31)<<6|h[++a]&63:(c&15)<<12|(h[++a]&63)<<6|h[++a]&63);f=a;return 10240>e.length?o.apply(null,e):k(e);case 198:if(a<f+4+1)break;d+=16777216*h[++f]+(h[++f]<<16);case 197:if(a<f+2+1)break;d+=h[++f]<<8;case 196:if(a<f+1)break;d+=h[++f];if(a<f+d+1)break;e=[];a=f;for(d=a+d;a<d;)c=h[++a],e.push(c);f=a;return 10240>e.length?o.apply(null,e):k(e);case 223:if(a<f+4+1)break;d+=16777216*h[++f]+(h[++f]<<16);case 222:if(a<f+2+1)break;d+=(h[++f]<<8)+h[++f];case 128:for(h={};d--;){if(a<f+1+1)return;c=b();if(void 0===
c)return;e=c;c=b();if(void 0===c)return;h[e]=c}return h;case 221:if(a<f+4+1)break;d+=16777216*h[++f]+(h[++f]<<16);case 220:if(a<f+2+1)break;d+=(h[++f]<<8)+h[++f];case 144:for(e=[];d--;){c=b();if(void 0===c)return;e.push(c)}return e}}function k(a){try{var c=o.apply(this,a);if(a.length!=c.length)throw"toString failed";return c}catch(b){}for(var c=[],e=0,f=a.length,g=n;e<f;++e)c[e]=g[a[e]];return c.join("")}function j(a){var c=[],b=l,e=a.split(""),f=-1,g;g=e.length;for(a=g%8;a--;)++f,c[f]=b[e[f]];for(a=
g>>3;a--;)c.push(b[e[++f]],b[e[++f]],b[e[++f]],b[e[++f]],b[e[++f]],b[e[++f]],b[e[++f]],b[e[++f]]);return c}g.msgpack={tofloat:a,unpacker:function(){var a={_chunk:[],_cidx:0,feed:function(c){c="string"===typeof c?j(c):c;a._chunk=a._chunk.concat(c)},unpack:function(){var b=c(a._chunk);if(void 0!==b)return a._cidx=f+1,a._chunk=a._chunk.slice(a._cidx),b},refresh:function(){a._chunk=[];a._cidx=0}};return a},pack:function(a,c){p=0;var b=e([],a,0);return p?!1:c?k(b):b},unpack:c};var l={},n={},m=[],f=0,p=
0,s=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},q=function(a){return"[object ArrayBuffer]"===Object.prototype.toString.call(a)},o=String.fromCharCode,r=512;a.prototype=new Number;a.prototype.valueOf=function(){return this._n};a.prototype.toString=function(){return this._n.toString()};(function(){for(var a=0,c;256>a;++a)c=o(a),l[c]=a,n[a]=c;for(a=128;256>a;++a)l[o(63232+a)]=a})()}(this);/*

 The MIT License (MIT)

 Copyright 2015 Sony Corporation

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
*/
this.linear||function(g){g.linear=function(){};g.linear.version="2.5.5";g.linear.sign="216d7f344fb000dc6f7450a038bef1bba3e867e0";g.linear.tofloat=function(a){return new msgpack.tofloat(a)};g.linear.tobinary=function(a){var c=Object.prototype.toString.call(a);if("[object String]"===c){for(var c=new Uint8Array(a.length),e=0;e<a.length;e++)c[e]=a.charCodeAt(e);return c.buffer}if("[object ArrayBuffer]"===c)return a;if(a&&"[object Object]"!==c&&"buffer"in a&&"[object ArrayBuffer]"===Object.prototype.toString.call(a.buffer))return a.buffer;
throw"can not convert into binary";};g.linear.base64=function(){var a=function(a){for(var e={},b=0,g=a.length;b<g;++b)e[a.charAt(b)]=b;return e}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");return{encode:function(a){var e=0;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";for(;a.length%3;)a+="\x00",e++;a=a.replace(/[\x00-\xFF]{3}/g,function(a){a=a.charCodeAt(0)<<16|a.charCodeAt(1)<<8|a.charCodeAt(2);return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>
18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)});if(!e)return a;for(a=a.substr(0,a.length-e);e--;)a+="=";return a},decode:function(c){var e=0;if("string"!==typeof c||c.length%4||null!==c.match(/[^A-Za-z0-9\+\/=]/)||-1!==c.indexOf("=")&&c.indexOf("=")<c.length-2)throw"INVALID_CHARACTER_ERR";for(c=
c.replace(/[^A-Za-z0-9\+\/]/g,"");c.length%4;)c+="A",e++;if(2<e)throw"INVALID_CHARACTER_ERR";c=c.replace(/[A-Za-z0-9\+\/]{4}/g,function(b){b=a[b.charAt(0)]<<18|a[b.charAt(1)]<<12|a[b.charAt(2)]<<6|a[b.charAt(3)];return String.fromCharCode(b>>16)+String.fromCharCode(b>>8&255)+String.fromCharCode(b&255)});1<=e&&(c=c.substring(0,c.length-[0,1,2][e]));return c}}}();g.linear.btoa=function(a){var c=g.btoa||g.linear.base64.encode;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";return c(a)};g.linear.atob=
function(a){var c=g.atob||g.linear.base64.decode;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";return c(a)};g.linear.extend=function(a,c){var e=new a;if(!c)return e;for(var b in c)e[b]!==c[b]&&(e[b]=c[b]);return e};g.linear.codec=function(){this.type=void 0};g.linear.codec.prototype.encode=function(a){return a};g.linear.codec.prototype.decode=function(a){return a};g.linear.codec.prototype.refresh=function(){};g.linear.codec.plain=function(){this.type="plain";return g.linear.extend(g.linear.codec,
this)};g.linear.codec.msgpack=function(){this.type="msgpack";this.unpacker=new msgpack.unpacker;return g.linear.extend(g.linear.codec,this)};g.linear.codec.msgpack.prototype.encode=function(a){return msgpack.pack(a)};g.linear.codec.msgpack.prototype.decode=function(a){var c=[];for(this.unpacker.feed(a);void 0!==(a=this.unpacker.unpack());)c.push(a);return c};g.linear.codec.msgpack.prototype.refresh=function(){this.unpacker.refresh()};g.linear.protocol=function(){this.codec=this.type=void 0};g.linear.protocol.prototype.request=
function(){throw Error("method is not allowed");};g.linear.protocol.prototype.response=function(){throw Error("method is not allowed");};g.linear.protocol.prototype.notify=function(){throw Error("method is not allowed");};g.linear.protocol.prototype.onmessage=function(a){return a};g.linear.protocol.prototype.reset=function(){};g.linear.protocol.plain=function(){this.type="plain";this.codec=new linear.codec.plain;return g.linear.extend(g.linear.protocol,this)};g.linear.protocol.plain.prototype.onmessage=
function(a){var c=[];a&&c.push({type:"notify",data:{name:void 0,data:a}});return c};g.linear.protocol.linear=function(){this.type="linear";this.msgid=0;this.codec=new g.linear.codec.msgpack;this.requests={};return g.linear.extend(g.linear.protocol,this)};g.linear.protocol.linear.prototype.request=function(a){var c=this,e={},b;if(a&&!("[object Object]"!==Object.prototype.toString.call(a)||!("method"in a)||!("params"in a))){do c.msgid=4294967295<=c.msgid?0:c.msgid+1;while(c.requests[c.msgid]);b=c.codec.encode([0,
c.msgid,a.method,a.params]);e.id=c.msgid;e.onresponse=a.onresponse;e.timeout=setTimeout(function(){c.ontimeout(e.id)},0<a.timeout?a.timeout:3E4);c.requests[e.id]=e;return{id:e.id,data:b,timeout:0<a.timeout?a.timeout:3E4}}};g.linear.protocol.linear.prototype.response=function(a){return!a||"[object Object]"!==Object.prototype.toString.call(a)||!("id"in a)?void 0:this.codec.encode([1,a.id,a.error,a.result])};g.linear.protocol.linear.prototype.notify=function(a){return!a||"[object Object]"!==Object.prototype.toString.call(a)||
!("name"in a)||!("data"in a)?void 0:this.codec.encode([2,a.name,a.data])};g.linear.protocol.linear.prototype.ontimeout=function(a){this.requests[a]&&("function"===typeof this.requests[a].onresponse&&this.requests[a].onresponse.call(this,{id:a,error:"timeout",result:null}),delete this.requests[a])};g.linear.protocol.linear.prototype.onmessage=function(a){var c=Object.prototype.toString.call(a),e,b=[],k,j;if("[object String]"===c)try{e=g.linear.atob(a)}catch(l){return console&&console.log("invalid data"),
b}else if("[object ArrayBuffer]"===c){e=[];k=new Uint8Array(a);a=0;for(c=k.length;a<c;a++)e[a]=k[a]}else if("[object Array]"===c||"[object Number]"===c)e=a;else return console&&console.log("invalid data"),b;e=this.codec.decode(e);a=0;for(c=e.length;a<c;++a)switch(e[a][0]){case 0:b.push({type:"request",data:{id:e[a][1],method:e[a][2],params:e[a][3]}});break;case 1:k=e[a][1];this.requests[k]&&(clearTimeout(this.requests.timer),"function"===typeof this.requests[k].onresponse?this.requests[k].onresponse.call(this,
{id:k,error:e[a][2],result:e[a][3]}):b.push({type:"response",data:{id:k,error:e[a][2],result:e[a][3]}}),delete this.requests[k]);break;case 2:k=e[a][1];j=e[a][2];b.push({type:"notify",data:{name:k,data:j}});break;default:console&&console.log("invalid data")}return b};g.linear.protocol.linear.prototype.reset=function(){this.codec.refresh()};g.linear.transport=function(){this.state="disconnected";this.sendbuffer=[];this.num2bin=[];for(var a=0;256>a;++a)this.num2bin[a]=String.fromCharCode(a)};g.linear.transport.create=
function(a){var c,e,b,g,j,l,n,m={},f;for(f in a)"type"===f.toLowerCase()&&(c=a[f]),"channel"===f.toLowerCase()&&(g=a[f]),"host"===f.toLowerCase()&&(e=a[f]),"port"===f.toLowerCase()&&(b=a[f]),"path"===f.toLowerCase()&&(j=a[f]),"usessl"===f.toLowerCase()&&(n=!!a[f]),"options"===f.toLowerCase()&&(l=a[f]);"undefined"===typeof n&&(n=!!location.protocol.match(/https/));c=c||"websocket";e=e||location.hostname;b=parseInt(b||location.port,10)||(n?443:80);g=g||"linear";g=g.match(/^\//)?g:"/"+g;if("websocket"===
c)a=n?"wss://"+e+(443===b?"":":"+b)+g:"ws://"+e+(80===b?"":":"+b)+g;else if("polling"===c)j=j||"cgi/linear.fcgi",j=j.match(/^\//)?j:"/"+j,a=n?"https://"+e+(443===b?"":":"+b)+j:"http://"+e+(80===b?"":":"+b)+j;else{console&&console.log("transport: "+m.type+" is not implemented.");return}m.type=c;m.entry={};m.entry.url=a;m.entry.channel=g;m.entry.options=l;return m};g.linear.transport.prototype.connect=function(a){function c(a){a&&a.currentTarget!==b.try_sock?(a.currentTarget.onclose=a.currentTarget.onerror=
null,a.currentTarget.close()):(b.type="websocket",b.raw=new g.linear.transport.websocket(b.try_sock),b.raw.onopen=function(a){b._onopen(a)},b.raw.onclose=b.raw.onerror=function(a){b._onclose(a)},b.raw.onmessage=function(a){b._onmessage(a)},b._onopen())}function e(){b.try_sock=void 0;b.entry.polling?(b.type="polling",b.raw=new g.linear.transport.polling(b.entry.polling.url,b.entry.polling.channel,b.entry.polling.options,function(){b._onopen()},function(){b._onclose()}),b.raw.onopen=function(a){b._onopen(a)},
b.raw.onclose=b.raw.onerror=function(a){b._onclose(a)},b.raw.onmessage=function(a){b._onmessage(a)}):b._onclose()}var b=this;if(!("connecting"===b.state||"connected"===b.state))if(b.state="connecting",a=a&&a.timeout?a.timeout:3E4,b.entry.websocket){try{b.try_sock=new WebSocket(b.entry.websocket.url)}catch(k){if(!b.entry.polling){b._onclose();return}b.type="polling";b.raw=new g.linear.transport.polling(b.entry.polling.url,b.entry.polling.channel,b.entry.polling.options,function(){b._onopen()},function(){b._onclose()});
b.raw.onopen=function(a){b._onopen(a)};b.raw.onclose=b.raw.onerror=function(a){b._onclose(a)};b.raw.onmessage=function(a){b._onmessage(a)};return}b.try_sock.onopen=c;b.try_sock.onclose=e;setTimeout(function(){"connecting"===b.state&&(b.try_sock.onopen=b.try_sock.onclose=b.try_sock.onerror=null,b.try_sock.close(),e())},a)}else b.entry.polling?(b.type="polling",b.raw=new g.linear.transport.polling(b.entry.polling.url,b.entry.polling.channel,b.entry.polling.options,function(){b._onopen()},function(){b._onclose()}),
b.raw.onopen=function(a){b._onopen(a)},b.raw.onclose=b.raw.onerror=function(a){b._onclose(a)},b.raw.onmessage=function(a){b._onmessage(a)},setTimeout(function(){"connecting"===b.state&&b._onclose()},a)):b._onclose()};g.linear.transport.prototype._onopen=function(a){if("connecting"===this.state){this.state="connected";for(var c=0,e=this.sendbuffer.length;c<e;++c)this.send(this.sendbuffer[c]);this.sendbuffer=[];if("function"===typeof this.onopen)this.onopen(a)}};g.linear.transport.prototype._onclose=
function(a){if("disconnected"!==this.state&&(this.state="disconnected","function"===typeof this.onclose))this.onclose(a)};g.linear.transport.prototype._onmessage=function(a){if("connected"===this.state&&"function"===typeof this.onmessage)this.onmessage(a)};g.linear.transport.prototype.disconnect=function(){"disconnected"!==this.state&&(this.state="disconnecting",this.sendbuffer=[],"function"===typeof this.raw.disconnect&&this.raw.disconnect())};g.linear.transport.prototype.send=function(a){var c,
e=Object.prototype.toString.call(a);if(!("disconnecting"===this.state||"disconnected"===this.state))if("connecting"===this.state)this.sendbuffer[this.sendbuffer.length]=a;else{if("[object String]"===e)c=a;else if("[object Array]"===e||"[object ArrayBuffer]"===e||"[object Uint8Array]"===e)if("text"===this.raw.type){c=[];for(var e=0,b=a.length;e<b;++e)c[e]=this.num2bin[a[e]];c=g.linear.btoa(c.join(""))}else"binary"===this.raw.type&&(c=(new Uint8Array(a)).buffer);else return;this.raw.send(c)}};g.linear.transport.websocket=
function(a){var c=this;c.socket=a;"binaryType"in c.socket?(c.socket.binaryType="arraybuffer",c.type="binary"):c.type="text";c.socket.onopen=function(a){if(typeof c.onopen==="function")c.onopen(a)};c.socket.onclose=c.socket.onerror=function(a){if(typeof c.onclose==="function")c.onclose(a);c.socket=void 0};c.socket.onmessage=function(a){if(typeof c.onmessage==="function")c.onmessage(a.data)}};g.linear.transport.websocket.prototype.disconnect=function(){this.socket.close()};g.linear.transport.websocket.prototype.send=
function(a){this.socket.send(a)};g.linear.jsonp={load:function(a,c,e){var b=document.createElement("iframe");b.style.display="none";document.body.appendChild(b);var g=b.contentWindow.document,j=!1;b[b.readyState?"onreadystatechange":"onload"]=function(){this.readyState&&"complete"!=this.readyState||j||(j=!0,g.x?"function"===typeof c&&c.apply(this,g.x):"function"===typeof e&&e(),setTimeout(function(){try{b.parentNode.removeChild(b)}catch(a){}},0))};a=a+(0>a.indexOf("?")?"?":"&")+"f=cb&"+(new Date).getTime();
g.write('<script>function cb(){document.x=arguments}<\/script><script src="'+a+'"><\/script>');g.close();return b},abort:function(a){a&&a.parentNode&&a.parentNode.removeChild(a)}};g.linear.transport.polling=function(a,c,e,b,k){this.type="text";this.url=a;this.channel=c;this.options=e||{};this.seq=0;this.sid=void 0;var j=this,l="?c=connect&ch="+this.channel;j.state="connecting";g.linear.jsonp.load(this.url+l,function(a){j.sid=a.sid;"connecting"!==j.state?(l="?c=disconnect&sid="+j.sid,g.linear.jsonp.load(j.url+
l)):(j.dopoll(),"function"===typeof b&&b())},k)};g.linear.transport.polling.prototype.disconnect=function(){var a="?c=disconnect&sid="+this.sid;if("disconnecting"!==this.state&&(this.state="disconnecting",this.intervaltimer&&clearTimeout(this.intervaltimer),this.seq=this.intervaltimer=0,void 0!==this.sid&&g.linear.jsonp.load(this.url+a),this.sid=void 0,"function"===typeof this.onclose))this.onclose()};g.linear.transport.polling.prototype.send=function(a){function c(a,b){if(b.confirmed)try{a.parentNode.removeChild(a),
b.parentNode.removeChild(b)}catch(e){}else b.confirmed=!0,a.submit(),setTimeout(function(){c(a,b)},j)}var e,b,g,j=this.options.gc||3E3;void 0===this.sid||"disconnecting"===this.state||(e=document.createElement("form"),e.style.display="none",e.action=this.url,e.method="POST",e.target="ifr"+this.seq,document.body.appendChild(e),b=document.createElement("input"),b.type="text",b.name="sid",b.value=this.sid,e.appendChild(b),b=document.createElement("input"),b.type="text",b.name="data",b.value=a,e.appendChild(b),
g=document.createElement("iframe"),g.style.display="none",g.name="ifr"+this.seq++,g.src="about:blank",g.onload=function(){c(e,g)},document.all&&(g.onreadystatechange=function(){"complete"===this.readyState&&(g.contentWindow.name=g.name,c(e,g))}),document.body.appendChild(g))};g.linear.transport.polling.prototype.dopoll=function(){function a(a){if(a&&"function"===typeof e.onmessage)e.onmessage(a);e.intervaltimer=setTimeout(function(){e.dopoll()},b)}function c(){e.disconnect()}var e=this,b,k="?c=poll&sid="+
this.sid;void 0===this.sid||"disconnecting"===this.state||(b=e.options?e.options.interval||250:250,g.linear.jsonp.load(this.url+k,a,c))};g.linear.client=function(a){var c=this,e,b;if("function"!==typeof c){for(var k in a)"protocol"===k.toLowerCase()&&(e=a[k]),"transports"===k.toLowerCase()&&(b=a[k]);e=e?e:"linear";try{c.protocol=new g.linear.protocol[e]}catch(j){console&&console.log("protocol: "+e+" is not implemented."),c.protocol=new g.linear.protocol.linear}c.transport=new g.linear.transport;c.transport.onopen=
function(a){c._onopen(a)};c.transport.onclose=function(a){c._onclose(a)};c.transport.onmessage=function(a){c._onmessage(a)};c.transport.entry={};a=Object.prototype.toString.call(b);if("[object String]"===a){if(a=g.linear.transport.create({type:b}))c.transport.entry[a.type]=a.entry}else if("[object Array]"===a){e=0;for(k=b.length;e<k;e++)if(a="string"===typeof b[e]?g.linear.transport.create({type:b[e]}):g.linear.transport.create(b[e]))c.transport.entry[a.type]=a.entry,a=void 0}else if(void 0!==b&&
"[object Object]"===a){if(a=g.linear.transport.create(b))c.transport.entry[a.type]=a.entry}else a=g.linear.transport.create({type:"websocket"}),c.transport.entry[a.type]=a.entry,a=g.linear.transport.create({type:"polling"}),c.transport.entry[a.type]=a.entry;return c}};g.linear.client.prototype.state=function(){return this.transport.state};g.linear.client.prototype.connect=function(a){"function"===typeof this.transport.connect&&this.transport.connect(a)};g.linear.client.prototype.onconnect=function(a){"function"===
typeof a&&(this.onconnect=a)};g.linear.client.prototype.disconnect=function(){"function"===typeof this.transport.disconnect&&this.transport.disconnect()};g.linear.client.prototype.ondisconnect=function(a){"function"===typeof a&&(this.ondisconnect=a)};g.linear.client.prototype.request=function(a){var c;if("function"===typeof this.protocol.request){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return-1;try{c=this.protocol.request(a)}catch(e){return-1}if(!c)return-1;
this.transport.send(c.data)}else return-1;return c.id};g.linear.client.prototype.onresponse=function(a){"function"===typeof a&&(this.onresponse=a)};g.linear.client.prototype.response=function(a){var c;if("function"===typeof this.protocol.response){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return!1;try{c=this.protocol.response(a)}catch(e){return!1}if(!c)return!1;this.transport.send(c)}else return!1;return!0};g.linear.client.prototype.notify=function(a){var c;
if("function"===typeof this.protocol.notify){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return!1;try{c=this.protocol.notify(a)}catch(e){return!1}if(!c)return!1;this.transport.send(c)}else return!1;return!0};g.linear.client.prototype.onnotify=function(a){"function"===typeof a&&(this.onnotify=a)};g.linear.client.prototype._onopen=function(){var a;this.hasOwnProperty("onconnect")&&"function"===typeof this.onconnect&&(document?"createEvent"in document?(a=document.createEvent("Event"),
a.initEvent("connected",!0,!0)):"createEventObject"in document?(a=document.createEventObject(),a.type="connected"):a={type:"connected"}:a={type:"connected"},this.onconnect(a))};g.linear.client.prototype._onclose=function(){var a;this.protocol.reset();this.hasOwnProperty("ondisconnect")&&"function"===typeof this.ondisconnect&&(document?"createEvent"in document?(a=document.createEvent("Event"),a.initEvent("disconnected",!0,!0)):"createEventObject"in document?(a=document.createEventObject(),a.type="disconnected"):
a={type:"disconnected"}:a={type:"disconnected"},this.ondisconnect(a))};g.linear.client.prototype._onmessage=function(a){for(var a=this.protocol.onmessage(a),c=0,e=a.length;c<e;c++)"request"===a[c].type?this.hasOwnProperty("onrequest")&&"function"===typeof this.onrequest&&this.onrequest.call(this,a[c].data):"response"===a[c].type?this.hasOwnProperty("onresponse")&&"function"===typeof this.onresponse&&this.onresponse.call(this,a[c].data):"notify"===a[c].type&&this.hasOwnProperty("onnotify")&&"function"===
typeof this.onnotify&&this.onnotify.call(this,a[c].data)}}(this);
