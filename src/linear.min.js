/*
 !{id:msgpack.codec.js,ver:1.05,license:"MIT",author:"uupaa.js@gmail.com"} */
this.msgpack||function(e){function a(a){this._n=a}function b(a){l="string"===typeof a?j(a):a;c=-1;return i()}function d(b,h,f){var c,g,i;if(null==h)b.push(192);else if(!1===h)b.push(194);else if(!0===h)b.push(195);else switch(typeof h){case "number":h!==h?b.push(203,255,255,255,255,255,255,255,255):Infinity===h?b.push(203,127,240,0,0,0,0,0,0):Math.floor(h)===h?0>h?-32<=h?b.push(224+h+32):-128<h?b.push(208,h+256):-32768<h?(h+=65536,b.push(209,h>>8,h&255)):-2147483648<h?(h+=4294967296,b.push(210,h>>>
24,h>>16&255,h>>8&255,h&255)):(g=Math.floor(h/4294967296),h&=4294967295,b.push(211,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255)):128>h?b.push(h):256>h?b.push(204,h):65536>h?b.push(205,h>>8,h&255):4294967296>h?b.push(206,h>>>24,h>>16&255,h>>8&255,h&255):(g=Math.floor(h/4294967296),h&=4294967295,b.push(207,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255)):((g=0>h)&&(h*=-1),i=Math.log(h)/0.6931471805599453+1023|0,c=h*Math.pow(2,1075-i),h=c&4294967295,g&&
(i|=2048),g=c/4294967296&1048575|i<<20,b.push(203,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255));break;case "string":f=h.length;i=b.length;b.push(0);for(g=0;g<f;++g)c=h.charCodeAt(g),128>c?b.push(c&127):2048>c?b.push(c>>>6&31|192,c&63|128):65536>c&&b.push(c>>>12&15|224,c>>>6&63|128,c&63|128);c=b.length-i-1;32>c?b[i]=160+c:65536>c?b.splice(i,1,218,c>>8,c&255):4294967296>c&&b.splice(i,1,219,c>>>24,c>>16&255,c>>8&255,c&255);break;default:if(++f>=q)return o=1,[];if(r(h)){c=h.length;
16>c?b.push(144+c):65536>c?b.push(220,c>>8,c&255):4294967296>c&&b.push(221,c>>>24,c>>16&255,c>>8&255,c&255);for(g=0;g<c;++g)d(b,h[g],f)}else if(h instanceof a)c=h.valueOf(),(g=0>c)&&(c*=-1),i=Math.log(c)/0.6931471805599453+1023|0,c*=Math.pow(2,1075-i),h=c&4294967295,g&&(i|=2048),g=c/4294967296&1048575|i<<20,b.push(203,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255);else if(p(h)||h&&"[object Object]"!==Object.prototype.toString.call(h)&&"buffer"in h&&"[object ArrayBuffer]"===
Object.prototype.toString.call(h.buffer)){h=p(h)?new Uint8Array(h):new Uint8Array(h.buffer);c=h.byteLength;256>c?b.push(196,c&255):65536>c?b.push(196,c>>8,c&255):4294967296>c&&b.push(198,c>>>24,c>>16&255,c>>8&255,c&255);for(g=0;g<c;g++)b.push(h[g]);delete h}else{i=b.length;b.push(0);c=0;for(g in h)++c,d(b,g,f),d(b,h[g],f);16>c?b[i]=128+c:65536>c?b.splice(i,1,222,c>>8,c&255):4294967296>c&&b.splice(i,1,223,c>>>24,c>>16&255,c>>8&255,c&255)}}return b}function i(){var a,b,d;b=0;var e,g;g=l;d=g[++c];a=
g.length;if(224<=d)return d-256;if(192>d){if(128>d)return d;144>d?(b=d-128,d=128):160>d?(b=d-144,d=144):(b=d-160,d=160)}switch(d){case 192:return null;case 194:return!1;case 195:return!0;case 202:if(a<c+4+1)break;b=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];a=b>>23&255;e=b&8388607;return!b||2147483648===b?0:255===a?e?NaN:Infinity:(b&2147483648?-1:1)*(e|8388608)*Math.pow(2,a-127-23);case 203:if(a<c+8+1)break;b=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];d=b&2147483648;a=b>>20&2047;e=b&1048575;
if(!b||2147483648===b)return c+=4,0;if(2047===a)return c+=4,e?NaN:Infinity;b=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];return(d?-1:1)*((e|1048576)*Math.pow(2,a-1023-20)+b*Math.pow(2,a-1023-52));case 207:if(a<c+8+1)break;b=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];return 4294967296*b+16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];case 206:if(a<c+4+1)break;b+=16777216*g[++c]+(g[++c]<<16);case 205:if(a<c+2+1)break;b+=g[++c]<<8;case 204:if(a<c+1+1)break;return b+g[++c];case 211:if(a<c+8+
1)break;b=g[++c];return b&128?-1*(72057594037927936*(b^255)+281474976710656*(g[++c]^255)+1099511627776*(g[++c]^255)+4294967296*(g[++c]^255)+16777216*(g[++c]^255)+65536*(g[++c]^255)+256*(g[++c]^255)+(g[++c]^255)+1):72057594037927936*b+281474976710656*g[++c]+1099511627776*g[++c]+4294967296*g[++c]+16777216*g[++c]+65536*g[++c]+256*g[++c]+g[++c];case 210:if(a<c+4+1)break;b=16777216*g[++c]+(g[++c]<<16)+(g[++c]<<8)+g[++c];return 2147483648>b?b:b-4294967296;case 209:if(a<c+2+1)break;b=(g[++c]<<8)+g[++c];
return 32768>b?b:b-65536;case 208:if(a<c+1+1)break;b=g[++c];return 128>b?b:b-256;case 219:if(a<c+4+1)break;b+=16777216*g[++c]+(g[++c]<<16);case 218:if(a<c+2+1)break;b+=g[++c]<<8;case 217:if(a<c+1)break;b+=g[++c];case 160:if(a<c+b+1)break;e=[];a=c;for(b=a+b;a<b;)d=g[++a],240<=d?(d=((d&3)<<18|(g[++a]&63)<<12|(g[++a]&63)<<6|g[++a]&63)-65536,e.push(55296+(d>>10)),e.push(56320+(d&1023))):e.push(128>d?d:224>d?(d&31)<<6|g[++a]&63:(d&15)<<12|(g[++a]&63)<<6|g[++a]&63);c=a;return 10240>e.length?n.apply(null,
e):f(e);case 198:if(a<c+4+1)break;b+=16777216*g[++c]+(g[++c]<<16);case 197:if(a<c+2+1)break;b+=g[++c]<<8;case 196:if(a<c+1)break;b+=g[++c];if(a<c+b+1)break;e=[];a=c;for(b=a+b;a<b;)d=g[++a],e.push(d);c=a;return 10240>e.length?n.apply(null,e):f(e);case 223:if(a<c+4+1)break;b+=16777216*g[++c]+(g[++c]<<16);case 222:if(a<c+2+1)break;b+=(g[++c]<<8)+g[++c];case 128:for(g={};b--;){if(a<c+1+1)return;d=i();if(void 0===d)return;e=d;d=i();if(void 0===d)return;g[e]=d}return g;case 221:if(a<c+4+1)break;b+=16777216*
g[++c]+(g[++c]<<16);case 220:if(a<c+2+1)break;b+=(g[++c]<<8)+g[++c];case 144:for(e=[];b--;){d=i();if(void 0===d)return;e.push(d)}return e}}function f(a){try{var b=n.apply(this,a);if(a.length!=b.length)throw"toString failed";return b}catch(c){}for(var b=[],d=0,f=a.length,e=m;d<f;++d)b[d]=e[a[d]];return b.join("")}function j(a){var b=[],c=k,d=a.split(""),f=-1,e;e=d.length;for(a=e%8;a--;)++f,b[f]=c[d[f]];for(a=e>>3;a--;)b.push(c[d[++f]],c[d[++f]],c[d[++f]],c[d[++f]],c[d[++f]],c[d[++f]],c[d[++f]],c[d[++f]]);
return b}e.msgpack={tofloat:a,unpacker:function(){var a={_chunk:[],_cidx:0,feed:function(b){b="string"===typeof b?j(b):b;a._chunk=a._chunk.concat(b)},unpack:function(){var d=b(a._chunk);if(void 0!==d)return a._cidx=c+1,a._chunk=a._chunk.slice(a._cidx),d},refresh:function(){a._chunk=[];a._cidx=0}};return a},pack:function(a,b){o=0;var c=d([],a,0);return o?!1:b?f(c):c},unpack:b};var k={},m={},l=[],c=0,o=0,r=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},p=function(a){return"[object ArrayBuffer]"===
Object.prototype.toString.call(a)},n=String.fromCharCode,q=512;a.prototype=new Number;a.prototype.valueOf=function(){return this._n};a.prototype.toString=function(){return this._n.toString()};(function(){for(var a=0,b;256>a;++a)b=n(a),k[b]=a,m[a]=b;for(a=128;256>a;++a)k[n(63232+a)]=a})()}(this);/*

 The MIT License (MIT)

 Copyright 2015 Sony Corporation

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
*/
this.linear||function(e){e.linear=function(){};e.linear.version="2.5.3";e.linear.sign="8c9cb3363143ff462d8bce8dfe654540b4298836";e.linear.tofloat=function(a){return new msgpack.tofloat(a)};e.linear.tobinary=function(a){var b=Object.prototype.toString.call(a);if("[object String]"===b){for(var b=new Uint8Array(a.length),d=0;d<a.length;d++)b[d]=a.charCodeAt(d);return b.buffer}if("[object ArrayBuffer]"===b)return a;if(a&&"[object Object]"!==b&&"buffer"in a&&"[object ArrayBuffer]"===Object.prototype.toString.call(a.buffer))return a.buffer;
throw"can not convert into binary";};e.linear.base64=function(){var a=function(a){for(var d={},e=0,f=a.length;e<f;++e)d[a.charAt(e)]=e;return d}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");return{encode:function(a){var d=0;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";for(;a.length%3;)a+="\x00",d++;a=a.replace(/[\x00-\xFF]{3}/g,function(a){a=a.charCodeAt(0)<<16|a.charCodeAt(1)<<8|a.charCodeAt(2);return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>
18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)});if(!d)return a;for(a=a.substr(0,a.length-d);d--;)a+="=";return a},decode:function(b){var d=0;if("string"!==typeof b||b.length%4||null!==b.match(/[^A-Za-z0-9\+\/=]/)||-1!==b.indexOf("=")&&b.indexOf("=")<b.length-2)throw"INVALID_CHARACTER_ERR";for(b=
b.replace(/[^A-Za-z0-9\+\/]/g,"");b.length%4;)b+="A",d++;if(2<d)throw"INVALID_CHARACTER_ERR";b=b.replace(/[A-Za-z0-9\+\/]{4}/g,function(b){b=a[b.charAt(0)]<<18|a[b.charAt(1)]<<12|a[b.charAt(2)]<<6|a[b.charAt(3)];return String.fromCharCode(b>>16)+String.fromCharCode(b>>8&255)+String.fromCharCode(b&255)});1<=d&&(b=b.substring(0,b.length-[0,1,2][d]));return b}}}();e.linear.btoa=function(a){var b=e.btoa||e.linear.base64.encode;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";return b(a)};e.linear.atob=
function(a){var b=e.atob||e.linear.base64.decode;if("string"!==typeof a)throw"INVALID_CHARACTER_ERR";return b(a)};e.linear.extend=function(a,b){var d=new a;if(!b)return d;for(var e in b)d[e]!==b[e]&&(d[e]=b[e]);return d};e.linear.codec=function(){this.type=void 0};e.linear.codec.prototype.encode=function(a){return a};e.linear.codec.prototype.decode=function(a){return a};e.linear.codec.prototype.refresh=function(){};e.linear.codec.plain=function(){this.type="plain";return e.linear.extend(e.linear.codec,
this)};e.linear.codec.msgpack=function(){this.type="msgpack";this.unpacker=new msgpack.unpacker;return e.linear.extend(e.linear.codec,this)};e.linear.codec.msgpack.prototype.encode=function(a){return msgpack.pack(a)};e.linear.codec.msgpack.prototype.decode=function(a){var b=[];for(this.unpacker.feed(a);void 0!==(a=this.unpacker.unpack());)b.push(a);return b};e.linear.codec.msgpack.prototype.refresh=function(){this.unpacker.refresh()};e.linear.protocol=function(){this.codec=this.type=void 0};e.linear.protocol.prototype.request=
function(){throw Error("method is not allowed");};e.linear.protocol.prototype.response=function(){throw Error("method is not allowed");};e.linear.protocol.prototype.notify=function(){throw Error("method is not allowed");};e.linear.protocol.prototype.onmessage=function(a){return a};e.linear.protocol.prototype.reset=function(){};e.linear.protocol.plain=function(){this.type="plain";this.codec=new linear.codec.plain;return e.linear.extend(e.linear.protocol,this)};e.linear.protocol.plain.prototype.onmessage=
function(a){var b=[];a&&b.push({type:"notify",data:{name:void 0,data:a}});return b};e.linear.protocol.linear=function(){this.type="linear";this.msgid=0;this.codec=new e.linear.codec.msgpack;this.requests={};return e.linear.extend(e.linear.protocol,this)};e.linear.protocol.linear.prototype.request=function(a){var b=this,d={},e;if(a&&!("[object Object]"!==Object.prototype.toString.call(a)||!("method"in a)||!("params"in a))){do b.msgid=4294967295<=b.msgid?0:b.msgid+1;while(b.requests[b.msgid]);e=b.codec.encode([0,
b.msgid,a.method,a.params]);d.id=b.msgid;d.onresponse=a.onresponse;d.timeout=setTimeout(function(){b.ontimeout(d.id)},0<a.timeout?a.timeout:3E4);b.requests[d.id]=d;return{id:d.id,data:e,timeout:0<a.timeout?a.timeout:3E4}}};e.linear.protocol.linear.prototype.response=function(a){return!a||"[object Object]"!==Object.prototype.toString.call(a)||!("id"in a)?void 0:this.codec.encode([1,a.id,a.error,a.result])};e.linear.protocol.linear.prototype.notify=function(a){return!a||"[object Object]"!==Object.prototype.toString.call(a)||
!("name"in a)||!("data"in a)?void 0:this.codec.encode([2,a.name,a.data])};e.linear.protocol.linear.prototype.ontimeout=function(a){this.requests[a]&&("function"===typeof this.requests[a].onresponse&&this.requests[a].onresponse.call(this,{id:a,error:"timeout",result:null}),delete this.requests[a])};e.linear.protocol.linear.prototype.onmessage=function(a){var b=Object.prototype.toString.call(a),d,i=[],f,j;if("[object String]"===b)try{d=e.linear.atob(a)}catch(k){return console&&console.log("invalid data"),
i}else if("[object ArrayBuffer]"===b){d=[];f=new Uint8Array(a);a=0;for(b=f.length;a<b;a++)d[a]=f[a]}else if("[object Array]"===b||"[object Number]"===b)d=a;else return console&&console.log("invalid data"),i;d=this.codec.decode(d);a=0;for(b=d.length;a<b;++a)switch(d[a][0]){case 0:i.push({type:"request",data:{id:d[a][1],method:d[a][2],params:d[a][3]}});break;case 1:f=d[a][1];this.requests[f]&&(clearTimeout(this.requests.timer),"function"===typeof this.requests[f].onresponse?this.requests[f].onresponse.call(this,
{id:f,error:d[a][2],result:d[a][3]}):i.push({type:"response",data:{id:f,error:d[a][2],result:d[a][3]}}),delete this.requests[f]);break;case 2:f=d[a][1];j=d[a][2];i.push({type:"notify",data:{name:f,data:j}});break;default:console&&console.log("invalid data")}return i};e.linear.protocol.linear.prototype.reset=function(){this.codec.refresh()};e.linear.transport=function(){this.state="disconnected";this.sendbuffer=[];this.num2bin=[];for(var a=0;256>a;++a)this.num2bin[a]=String.fromCharCode(a)};e.linear.transport.create=
function(a){var b,d,e,f,j,k,m,l={},c;for(c in a)"type"===c.toLowerCase()&&(b=a[c]),"channel"===c.toLowerCase()&&(f=a[c]),"host"===c.toLowerCase()&&(d=a[c]),"port"===c.toLowerCase()&&(e=a[c]),"path"===c.toLowerCase()&&(j=a[c]),"usessl"===c.toLowerCase()&&(m=!!a[c]),"options"===c.toLowerCase()&&(k=a[c]);"undefined"===typeof m&&(m=!!location.protocol.match(/https/));b=b||"websocket";d=d||location.hostname;e=parseInt(e||location.port,10)||(m?443:80);f=f||"linear";f=f.match(/^\//)?f:"/"+f;if("websocket"===
b)a=m?"wss://"+d+(443===e?"":":"+e)+f:"ws://"+d+(80===e?"":":"+e)+f;else if("polling"===b)j=j||"cgi/linear.fcgi",j=j.match(/^\//)?j:"/"+j,a=m?"https://"+d+(443===e?"":":"+e)+j:"http://"+d+(80===e?"":":"+e)+j;else{console&&console.log("transport: "+l.type+" is not implemented.");return}l.type=b;l.entry={};l.entry.url=a;l.entry.channel=f;l.entry.options=k;return l};e.linear.transport.prototype.connect=function(a){function b(){f.type="websocket";f.raw=new e.linear.transport.websocket(i);f.raw.onopen=
function(a){f._onopen(a)};f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)};f.raw.onmessage=function(a){f._onmessage(a)};f._onopen()}function d(){i=void 0;f.entry.polling?(f.type="polling",f.raw=new e.linear.transport.polling(f.entry.polling.url,f.entry.polling.channel,f.entry.polling.options,function(){f._onopen()},function(){f._onclose()}),f.raw.onopen=function(a){f._onopen(a)},f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)},f.raw.onmessage=function(a){f._onmessage(a)}):f._onclose()}
var i,f=this;if(!("connecting"===f.state||"connected"===f.state))if(f.state="connecting",a=a&&a.timeout?a.timeout:3E4,f.entry.websocket){try{i=new WebSocket(f.entry.websocket.url)}catch(j){if(!f.entry.polling){f._onclose();return}f.type="polling";f.raw=new e.linear.transport.polling(f.entry.polling.url,f.entry.polling.channel,f.entry.polling.options,function(){f._onopen()},function(){f._onclose()});f.raw.onopen=function(a){f._onopen(a)};f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)};f.raw.onmessage=
function(a){f._onmessage(a)};return}i.onopen=b;i.onclose=d;setTimeout(function(){"connecting"===f.state&&d()},a)}else f.entry.polling?(f.type="polling",f.raw=new e.linear.transport.polling(f.entry.polling.url,f.entry.polling.channel,f.entry.polling.options,function(){f._onopen()},function(){f._onclose()}),f.raw.onopen=function(a){f._onopen(a)},f.raw.onclose=f.raw.onerror=function(a){f._onclose(a)},f.raw.onmessage=function(a){f._onmessage(a)},setTimeout(function(){"connecting"===f.state&&f._onclose()},
a)):f._onclose()};e.linear.transport.prototype._onopen=function(a){if("connecting"===this.state){this.state="connected";for(var b=0,d=this.sendbuffer.length;b<d;++b)this.send(this.sendbuffer[b]);this.sendbuffer=[];if("function"===typeof this.onopen)this.onopen(a)}};e.linear.transport.prototype._onclose=function(a){if("disconnected"!==this.state&&(this.state="disconnected","function"===typeof this.onclose))this.onclose(a)};e.linear.transport.prototype._onmessage=function(a){if("connected"===this.state&&
"function"===typeof this.onmessage)this.onmessage(a)};e.linear.transport.prototype.disconnect=function(){"disconnected"!==this.state&&(this.state="disconnecting",this.sendbuffer=[],"function"===typeof this.raw.disconnect&&this.raw.disconnect())};e.linear.transport.prototype.send=function(a){var b,d=Object.prototype.toString.call(a);if(!("disconnecting"===this.state||"disconnected"===this.state))if("connecting"===this.state)this.sendbuffer[this.sendbuffer.length]=a;else{if("[object String]"===d)b=
a;else if("[object Array]"===d||"[object ArrayBuffer]"===d||"[object Uint8Array]"===d)if("text"===this.raw.type){b=[];for(var d=0,i=a.length;d<i;++d)b[d]=this.num2bin[a[d]];b=e.linear.btoa(b.join(""))}else"binary"===this.raw.type&&(b=(new Uint8Array(a)).buffer);else return;this.raw.send(b)}};e.linear.transport.websocket=function(a){var b=this;b.socket=a;"binaryType"in b.socket?(b.socket.binaryType="arraybuffer",b.type="binary"):b.type="text";b.socket.onopen=function(a){if(typeof b.onopen==="function")b.onopen(a)};
b.socket.onclose=b.socket.onerror=function(a){if(typeof b.onclose==="function")b.onclose(a);b.socket=void 0};b.socket.onmessage=function(a){if(typeof b.onmessage==="function")b.onmessage(a.data)}};e.linear.transport.websocket.prototype.disconnect=function(){this.socket.close()};e.linear.transport.websocket.prototype.send=function(a){this.socket.send(a)};e.linear.jsonp={load:function(a,b,d){var e=document.createElement("iframe");e.style.display="none";document.body.appendChild(e);var f=e.contentWindow.document,
j=!1;e[e.readyState?"onreadystatechange":"onload"]=function(){this.readyState&&"complete"!=this.readyState||j||(j=!0,f.x?"function"===typeof b&&b.apply(this,f.x):"function"===typeof d&&d(),setTimeout(function(){try{e.parentNode.removeChild(e)}catch(a){}},0))};a=a+(0>a.indexOf("?")?"?":"&")+"f=cb&"+(new Date).getTime();f.write('<script>function cb(){document.x=arguments}<\/script><script src="'+a+'"><\/script>');f.close();return e},abort:function(a){a&&a.parentNode&&a.parentNode.removeChild(a)}};e.linear.transport.polling=
function(a,b,d,i,f){this.type="text";this.url=a;this.channel=b;this.options=d||{};this.seq=0;this.sid=void 0;var j=this,k="?c=connect&ch="+this.channel;j.state="connecting";e.linear.jsonp.load(this.url+k,function(a){j.sid=a.sid;"connecting"!==j.state?(k="?c=disconnect&sid="+j.sid,e.linear.jsonp.load(j.url+k)):(j.dopoll(),"function"===typeof i&&i())},f)};e.linear.transport.polling.prototype.disconnect=function(){var a="?c=disconnect&sid="+this.sid;if("disconnecting"!==this.state&&(this.state="disconnecting",
this.intervaltimer&&clearTimeout(this.intervaltimer),this.seq=this.intervaltimer=0,void 0!==this.sid&&e.linear.jsonp.load(this.url+a),this.sid=void 0,"function"===typeof this.onclose))this.onclose()};e.linear.transport.polling.prototype.send=function(a){function b(a,d){if(d.confirmed)try{a.parentNode.removeChild(a),d.parentNode.removeChild(d)}catch(e){}else d.confirmed=!0,a.submit(),setTimeout(function(){b(a,d)},j)}var d,e,f,j=this.options.gc||3E3;void 0===this.sid||"disconnecting"===this.state||
(d=document.createElement("form"),d.style.display="none",d.action=this.url,d.method="POST",d.target="ifr"+this.seq,document.body.appendChild(d),e=document.createElement("input"),e.type="text",e.name="sid",e.value=this.sid,d.appendChild(e),e=document.createElement("input"),e.type="text",e.name="data",e.value=a,d.appendChild(e),f=document.createElement("iframe"),f.style.display="none",f.name="ifr"+this.seq++,f.src="about:blank",f.onload=function(){b(d,f)},document.all&&(f.onreadystatechange=function(){"complete"===
this.readyState&&(f.contentWindow.name=f.name,b(d,f))}),document.body.appendChild(f))};e.linear.transport.polling.prototype.dopoll=function(){function a(a){if(a&&"function"===typeof d.onmessage)d.onmessage(a);d.intervaltimer=setTimeout(function(){d.dopoll()},i)}function b(){d.disconnect()}var d=this,i,f="?c=poll&sid="+this.sid;void 0===this.sid||"disconnecting"===this.state||(i=d.options?d.options.interval||250:250,e.linear.jsonp.load(this.url+f,a,b))};e.linear.client=function(a){var b=this,d,i;if("function"!==
typeof b){for(var f in a)"protocol"===f.toLowerCase()&&(d=a[f]),"transports"===f.toLowerCase()&&(i=a[f]);d=d?d:"linear";try{b.protocol=new e.linear.protocol[d]}catch(j){console&&console.log("protocol: "+d+" is not implemented."),b.protocol=new e.linear.protocol.linear}b.transport=new e.linear.transport;b.transport.onopen=function(a){b._onopen(a)};b.transport.onclose=function(a){b._onclose(a)};b.transport.onmessage=function(a){b._onmessage(a)};b.transport.entry={};a=Object.prototype.toString.call(i);
if("[object String]"===a){if(a=e.linear.transport.create({type:i}))b.transport.entry[a.type]=a.entry}else if("[object Array]"===a){d=0;for(f=i.length;d<f;d++)if(a="string"===typeof i[d]?e.linear.transport.create({type:i[d]}):e.linear.transport.create(i[d]))b.transport.entry[a.type]=a.entry,a=void 0}else if(void 0!==i&&"[object Object]"===a){if(a=e.linear.transport.create(i))b.transport.entry[a.type]=a.entry}else a=e.linear.transport.create({type:"websocket"}),b.transport.entry[a.type]=a.entry,a=e.linear.transport.create({type:"polling"}),
b.transport.entry[a.type]=a.entry;return b}};e.linear.client.prototype.state=function(){return this.transport.state};e.linear.client.prototype.connect=function(a){"function"===typeof this.transport.connect&&this.transport.connect(a)};e.linear.client.prototype.onconnect=function(a){"function"===typeof a&&(this.onconnect=a)};e.linear.client.prototype.disconnect=function(){"function"===typeof this.transport.disconnect&&this.transport.disconnect()};e.linear.client.prototype.ondisconnect=function(a){"function"===
typeof a&&(this.ondisconnect=a)};e.linear.client.prototype.request=function(a){var b;if("function"===typeof this.protocol.request){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return-1;try{b=this.protocol.request(a)}catch(d){return-1}if(!b)return-1;this.transport.send(b.data)}else return-1;return b.id};e.linear.client.prototype.onresponse=function(a){"function"===typeof a&&(this.onresponse=a)};e.linear.client.prototype.response=function(a){var b;if("function"===
typeof this.protocol.response){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return!1;try{b=this.protocol.response(a)}catch(d){return!1}if(!b)return!1;this.transport.send(b)}else return!1;return!0};e.linear.client.prototype.notify=function(a){var b;if("function"===typeof this.protocol.notify){if("disconnected"===this.transport.state||"disconnecting"===this.transport.state)return!1;try{b=this.protocol.notify(a)}catch(d){return!1}if(!b)return!1;this.transport.send(b)}else return!1;
return!0};e.linear.client.prototype.onnotify=function(a){"function"===typeof a&&(this.onnotify=a)};e.linear.client.prototype._onopen=function(){var a;this.hasOwnProperty("onconnect")&&"function"===typeof this.onconnect&&(document?"createEvent"in document?(a=document.createEvent("Event"),a.initEvent("connected",!0,!0)):"createEventObject"in document?(a=document.createEventObject(),a.type="connected"):a={type:"connected"}:a={type:"connected"},this.onconnect(a))};e.linear.client.prototype._onclose=function(){var a;
this.protocol.reset();this.hasOwnProperty("ondisconnect")&&"function"===typeof this.ondisconnect&&(document?"createEvent"in document?(a=document.createEvent("Event"),a.initEvent("disconnected",!0,!0)):"createEventObject"in document?(a=document.createEventObject(),a.type="disconnected"):a={type:"disconnected"}:a={type:"disconnected"},this.ondisconnect(a))};e.linear.client.prototype._onmessage=function(a){for(var a=this.protocol.onmessage(a),b=0,d=a.length;b<d;b++)"request"===a[b].type?this.hasOwnProperty("onrequest")&&
"function"===typeof this.onrequest&&this.onrequest.call(this,a[b].data):"response"===a[b].type?this.hasOwnProperty("onresponse")&&"function"===typeof this.onresponse&&this.onresponse.call(this,a[b].data):"notify"===a[b].type&&this.hasOwnProperty("onnotify")&&"function"===typeof this.onnotify&&this.onnotify.call(this,a[b].data)}}(this);
